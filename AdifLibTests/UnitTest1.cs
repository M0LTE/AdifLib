using FluentAssertions;
using M0LTE.AdifLib;
using System;
using System.Globalization;
using System.Linq;
using Xunit;

namespace AdifLibTests
{
    public class UnitTest1
    {
        [Fact]
        public void RecordFromCode()
        {
            var target = new AdifContactRecord();
            string call = "M0LTE";
            target.Call = call;
            target.Fields.Should().ContainKey("call");
            target.Fields["call"].Should().Be(call);
            target.Call.Should().Be(call);
            target.ToString().Should().Be("<call:5>M0LTE\n<eor>");
        }

        /*[Fact]
        public void ObjectFromRecord()
        {
            AdifContactRecord.TryParse("<call:5>M0LTE <eor>", out var record, out string error).Should().BeTrue();
            record.Should().NotBeNull();
            error.Should().BeNull();
            record.Call.Should().Be("M0LTE");
            record.Fields["call"].Should().Be("M0LTE");
        }*/

        [Fact]
        public void FileObjectFromString()
        {
            string adif = @"
<adif_ver:5>3.1.0
<programid:6>WSJT-X
<EOH>
<call:6>DL8RBL <gridsquare:4>JN68 <mode:3>FT8 <rst_sent:3>+01 <rst_rcvd:3>-01 <qso_date:8>20200823 <time_on:6>153730 <qso_date_off:8>20200823 <time_off:6>153830 <band:3>10m <freq:9>28.074712 <station_callsign:5>M0LTE <my_gridsquare:6>IO91LK <tx_pwr:3>30W <EOR>
<call:6>2E1EPQ <EOR>";

            AdifFile.TryParse(adif, out var adifFile).Should().BeTrue();
            adifFile.Header.Should().NotBeNull();
            adifFile.Header.AdifVersion.Should().Be("3.1.0");
            adifFile.Header.ProgramId.Should().Be("WSJT-X");
            adifFile.Records.Should().NotBeNull();
            adifFile.Records.Should().HaveCount(2);
            adifFile.Records[0].Call.Should().Be("DL8RBL");
            adifFile.Records[0].GridSquare.Should().Be("JN68");
            adifFile.Records[0].Mode.Should().Be("FT8");
            adifFile.Records[0].RstSent.Should().Be("+01");
            adifFile.Records[0].RstReceived.Should().Be("-01");
            adifFile.Records[0].QsoStart.Should().Be(DateTime.Parse("2020-08-23T15:37:30Z", CultureInfo.InvariantCulture, DateTimeStyles.AssumeUniversal | DateTimeStyles.AdjustToUniversal));
            adifFile.Records[0].QsoEnd.Should().Be(DateTime.Parse("2020-08-23T15:38:30Z", CultureInfo.InvariantCulture, DateTimeStyles.AssumeUniversal | DateTimeStyles.AdjustToUniversal));
            adifFile.Records[0].Band.Should().Be("10m");
            adifFile.Records[0].FreqMHz.Should().Be("28.074712");
            adifFile.Records[0].StationCallsign.Should().Be("M0LTE");
            adifFile.Records[0].MyGridSquare.Should().Be("IO91LK");
            adifFile.Records[0].TxPower.Should().Be("30W");
            adifFile.Records[1].Call.Should().Be("2E1EPQ");
        }

        [Fact]
        public void SampleFile1()
        {
            const string adif = @"Cloudlog ADIF export
<ADIF_VER:5>3.1.2
<PROGRAMID:8>Cloudlog
<PROGRAMVERSION:11>Version 1.7
<EOH>

<call:5>GX3CO <gridsquare:6>JO01KV <mode:3>FT8 <rst_sent:3>+11 <rst_rcvd:3>+12 <qso_date:8>20220409 <time_on:6>160030 <qso_date_off:8>20220409 <time_off:6>160130 <band:3>40m <freq:8>7.075685 <station_callsign:5>M0LTE <my_gridsquare:6>IO91LK <tx_pwr:4>200W <operator:5>M0LTE <eor>
<call:5>G6YWL <gridsquare:6>IO82XN <mode:3>FT8 <rst_sent:3>+18 <rst_rcvd:3>+07 <qso_date:8>20220409 <time_on:6>160630 <qso_date_off:8>20220409 <time_off:6>160730 <band:3>40m <freq:8>7.075685 <station_callsign:5>M0LTE <my_gridsquare:6>IO91LK <tx_pwr:4>200W <operator:5>M0LTE <eor>
<call:5>G0FOG <gridsquare:6>IO92NW <mode:3>FT8 <rst_sent:3>+12 <rst_rcvd:3>+19 <qso_date:8>20220409 <time_on:6>160815 <qso_date_off:8>20220409 <time_off:6>160915 <band:3>40m <freq:8>7.075685 <station_callsign:5>M0LTE <my_gridsquare:6>IO91LK <tx_pwr:4>200W <operator:5>M0LTE <eor>
<call:5>ON3CH <gridsquare:6>JO20WO <mode:3>FT8 <rst_sent:3>-17 <rst_rcvd:3>-08 <qso_date:8>20220409 <time_on:6>161000 <qso_date_off:8>20220409 <time_off:6>161100 <band:3>40m <freq:8>7.075685 <station_callsign:5>M0LTE <my_gridsquare:6>IO91LK <tx_pwr:4>200W <operator:5>M0LTE <eor>
<call:5>F4FSY <gridsquare:6>JN25KM <mode:3>FT8 <rst_sent:3>+12 <rst_rcvd:3>-02 <qso_date:8>20220409 <time_on:6>161200 <qso_date_off:8>20220409 <time_off:6>161300 <band:3>40m <freq:8>7.075685 <station_callsign:5>M0LTE <my_gridsquare:6>IO91LK <tx_pwr:4>200W <operator:5>M0LTE <eor>
<call:5>M6HTF <gridsquare:6>IO91SR <mode:3>FT8 <rst_sent:3>+08 <rst_rcvd:3>+23 <qso_date:8>20220409 <time_on:6>161330 <qso_date_off:8>20220409 <time_off:6>161430 <band:3>40m <freq:8>7.075685 <station_callsign:5>M0LTE <my_gridsquare:6>IO91LK <tx_pwr:4>200W <operator:5>M0LTE <eor>
<call:5>GX3CO <gridsquare:6>JO01KV <mode:3>FT8 <rst_sent:3>+07 <rst_rcvd:3>+11 <qso_date:8>20220409 <time_on:6>161652 <qso_date_off:8>20220409 <time_off:6>161730 <band:3>40m <freq:8>7.075685 <station_callsign:5>M0LTE <my_gridsquare:6>IO91LK <tx_pwr:4>200W <operator:5>M0LTE <eor>";

            AdifFile.TryParse(adif, out var file).Should().BeTrue();

            file.Records[6].Call.Should().Be("GX3CO");
            file.Records[6].GridSquare.Should().Be("JO01KV");
            file.Records[6].Mode.Should().Be("FT8");
            file.Records[6].RstSent.Should().Be("+07");
            file.Records[6].RstReceived.Should().Be("+11");
            file.Records[6].QsoStart.Should().Be(new DateTime(2022, 4, 9, 16, 16, 52));
            file.Records[6].Band.Should().Be("40m");
            file.Records[6].FreqMHz.Should().Be("7.075685");
            file.Records[6].StationCallsign.Should().Be("M0LTE");
            file.Records[6].MyGridSquare.Should().Be("IO91LK");
            file.Records[6].TxPower.Should().Be("200W");
            file.Records[6].Fields["operator"].Should().Be("M0LTE");
        }

        [Fact]
        public void N1mmAdifExport()
        {
            const string adif = @"ADIF Export from N1MMLogger.net - Version 1.0.9700.0
Built: 25/10/2022 13:21:24
M0LTE logs generated @ 2022-10-30 22:12:51Z
Contest Name: CQWWSSB - 2022-10-29
<EOH>
 <CALL:4>UA4M <QSO_DATE:8>20221029 <TIME_ON:6>181411 <TIME_OFF:6>181415 <BAND:3>40M <STATION_CALLSIGN:5>M0LTE <FREQ:7>7.10400 <CONTEST_ID:9>CQ-WW-SSB <FREQ_RX:7>7.10500 <MODE:3>SSB <RST_RCVD:2>59 <RST_SENT:2>58 <OPERATOR:5>M0LTE <CQZ:2>16 <STX:1>1 <APP_N1MM_POINTS:1>1 <APP_N1MM_RADIO_NR:1>1 <APP_N1MM_CONTINENT:2>EU <APP_N1MM_RUN1RUN2:1>1 <APP_N1MM_RADIOINTERFACED:1>1 <APP_N1MM_ISORIGINAL:4>True <APP_N1MM_NETBIOSNAME:8>STUDY-PC <APP_N1MM_ISRUNQSO:1>0 <PFX:3>UA4 <APP_N1MM_MULT1:1>1 <APP_N1MM_MULT2:1>1 <APP_N1MM_MULT3:1>0 <APP_N1MM_ID:32>9e3c709fa5084f82bae05f1ec48b9cd3 <APP_N1MM_CLAIMEDQSO:1>1 <EOR>
 <CALL:5>PA6DX <QSO_DATE:8>20221029 <TIME_ON:6>181433 <TIME_OFF:6>181433 <BAND:3>40M <STATION_CALLSIGN:5>M0LTE <FREQ:7>7.10950 <CONTEST_ID:9>CQ-WW-SSB <FREQ_RX:7>7.10950 <MODE:3>SSB <RST_RCVD:2>59 <RST_SENT:2>59 <OPERATOR:5>M0LTE <CQZ:2>14 <STX:1>2 <APP_N1MM_POINTS:1>1 <APP_N1MM_RADIO_NR:1>1 <APP_N1MM_CONTINENT:2>EU <APP_N1MM_RUN1RUN2:1>1 <APP_N1MM_RADIOINTERFACED:1>1 <APP_N1MM_ISORIGINAL:4>True <APP_N1MM_NETBIOSNAME:8>STUDY-PC <APP_N1MM_ISRUNQSO:1>0 <PFX:3>PA6 <APP_N1MM_MULT1:1>1 <APP_N1MM_MULT2:1>1 <APP_N1MM_MULT3:1>0 <APP_N1MM_ID:32>9e2f25b583df420e844d31c32369ff78 <APP_N1MM_CLAIMEDQSO:1>1 <EOR>";

            AdifFile.TryParse(adif, out var file).Should().BeTrue();

            file.Records.Count.Should().Be(2);

            var r1 = file.Records[0];
            r1.Call.Should().Be("UA4M");
            r1.QsoStart.Should().Be(new DateTime(2022, 10, 29, 18, 14, 11));
            r1.QsoEnd.Should().Be(new DateTime(2022, 10, 29, 18, 14, 15));
            r1.Band.Should().Be("40M");
            r1.StationCallsign.Should().Be("M0LTE");
            r1.FreqMHz.Should().Be("7.10400");
            r1.Fields["contest_id"].Should().Be("CQ-WW-SSB");
            r1.FreqRxMHz.Should().Be("7.10500");
            r1.Mode.Should().Be("SSB");
            r1.RstReceived.Should().Be("59");
            r1.RstSent.Should().Be("58");
            r1.Operator.Should().Be("M0LTE");
            r1.CQZone.Should().Be(16);
            r1.TransmittedSerial.Should().Be("1");
        }

        [Fact]
        public void CloudlogExport()
        {
            const string adif = @"Cloudlog ADIF export
<ADIF_VER:5>3.1.2
<PROGRAMID:8>Cloudlog
<PROGRAMVERSION:11>Version 1.7
<EOH>

<BAND:3>20m
<CALL:5>S79KW
<COUNTRY:18>Seychelles Islands  
<CQZ:2>39
<DXCC:3>379
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>LI75rj
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-11
<RST_SENT:3>-16
<TX_PWR:3>400
<EQSL_QSLSDATE:8>20201101
<LOTW_QSLRDATE:8>20201109
<LOTW_QSLSDATE:8>20201101
<FREQ:9>14.075995
<QSO_DATE:8>20201101
<TIME_ON:6>072900
<QSO_DATE_OFF:8>20201101
<TIME_OFF:6>072900
<STATION_CALLSIGN:5>M0LTE
<MY_CITY:7>Reading
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO91lk
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<MY_CNTY:3>223
<eor>

<BAND:3>20m
<CALL:5>UN7ZV
<COUNTRY:10>Kazakhstan
<CQZ:2>17
<DXCC:3>130
<EQSL_QSL_RCVD:1>Y
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>MO51rd
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-10
<RST_SENT:3>-17
<TX_PWR:3>400
<EQSL_QSLRDATE:8>20201101
<EQSL_QSLSDATE:8>20201101
<LOTW_QSLRDATE:8>20201101
<LOTW_QSLSDATE:8>20201101
<FREQ:9>14.075995
<QSO_DATE:8>20201101
<TIME_ON:6>075300
<QSO_DATE_OFF:8>20201101
<TIME_OFF:6>075600
<STATION_CALLSIGN:5>M0LTE
<MY_CITY:7>Reading
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO91lk
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<MY_CNTY:3>223
<eor>";

            AdifFile.TryParse(adif, out var file).Should().BeTrue();

            file.Records.Count.Should().Be(2);
            file.Records[0].Fields.Count.Should().Be(31);
            file.Records[0].Band.Should().Be("20m");
            file.Records[0].Country.Should().Be("Seychelles Islands");
        }

        [Fact]
        public void Vqlog()
        {
            const string adif = @"Summary of QSO. Generated with VQLog 3.1 by EA6VQ (WWW.VQLOG.COM)
Selection of QSO worked by any callsign on all bands
Type of propagation: All                Mode: All mode
From 20/12/2022 to 21/12/2022           Distance over: 0 Km.
<PROGRAMID:5>VQLog
<PROGRAMVERSION:7>3.1.683
<EOH>
<QSO_DATE:8>20221220<TIME_ON:4>0851<TIME_OFF:4>0852<CALL:5>F1TRF<RST_SENT:3>+04<RST_RCVD:3>-17<BAND:3>40m<FREQ:6>7.0759<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JN39CC<COMMENT:8>Vertical<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>227<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>0853<TIME_OFF:4>0854<CALL:5>OH3NK<RST_SENT:3>-10<RST_RCVD:3>-15<BAND:3>40m<FREQ:6>7.0759<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>KP20JT<COMMENT:8>Vertical<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>224<CQZ:2>15<ITUZ:2>18<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1055<TIME_OFF:4>1056<CALL:6>SP5AOZ<RST_SENT:3>-01<RST_RCVD:3>+01<BAND:2>6m<FREQ:7>50.3149<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>KO02LI<COMMENT:6>Dipole<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>269<CQZ:2>15<ITUZ:2>28<CONT:2>EU<TX_PWR:3>50W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1609<TIME_OFF:4>1610<CALL:4>9A5E<RST_SENT:3>-08<RST_RCVD:3>-22<BAND:3>40m<FREQ:6>7.0756<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JN75UV<COMMENT:8>Vertical<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>497<CQZ:2>15<ITUZ:2>28<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1614<TIME_OFF:4>1615<CALL:4>R5AV<RST_SENT:3>-06<RST_RCVD:3>-16<BAND:3>40m<FREQ:6>7.0759<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>KO95IM<COMMENT:6>Dipole<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:2>54<CQZ:2>16<ITUZ:2>29<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1615<TIME_OFF:4>1616<CALL:5>YO4NF<RST_SENT:3>+03<RST_RCVD:3>-12<BAND:3>40m<FREQ:6>7.0759<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>KN44HD<COMMENT:6>Dipole<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>275<CQZ:2>20<ITUZ:2>28<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1617<TIME_OFF:4>1618<CALL:6>SP7ENZ<RST_SENT:3>-03<RST_RCVD:3>-17<BAND:3>40m<FREQ:6>7.0759<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>KO00IK<COMMENT:6>Dipole<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>269<CQZ:2>15<ITUZ:2>28<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1620<TIME_OFF:4>1622<CALL:5>F6ARS<RST_SENT:3>+07<RST_RCVD:3>-22<BAND:3>40m<FREQ:6>7.0759<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JN38CP<COMMENT:6>Dipole<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>227<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1633<TIME_OFF:4>1634<CALL:5>OH3BY<RST_SENT:3>-05<RST_RCVD:3>-10<BAND:3>40m<FREQ:6>7.0758<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>KP20UX<COMMENT:6>Dipole<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>224<CQZ:2>15<ITUZ:2>18<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1826<TIME_OFF:4>1827<CALL:6>IT9DSZ<RST_SENT:3>-02<RST_RCVD:3>-04<BAND:3>30m<FREQ:7>10.1377<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JM68PC<COMMENT:8>Vertical<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>248<CQZ:2>15<ITUZ:2>28<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1833<TIME_OFF:4>1834<CALL:6>LZ1SAD<RST_SENT:3>-11<RST_RCVD:3>-13<BAND:3>30m<FREQ:7>10.1376<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>KN22ID<COMMENT:8>Vertical<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>212<CQZ:2>20<ITUZ:2>28<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2002<TIME_OFF:4>2002<CALL:5>G4ODA<RST_SENT:4>59 1<RST_RCVD:4>57 3<BAND:4>23cm<FREQ:8>1296.258<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO92WS<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2005<TIME_OFF:4>2005<CALL:7>G0FVI/P<RST_SENT:4>59 2<RST_RCVD:4>59 5<BAND:4>23cm<FREQ:8>1296.215<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO93RD<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2007<TIME_OFF:4>2007<CALL:5>G5ROC<RST_SENT:4>59 3<RST_RCVD:4>55 6<BAND:4>23cm<FREQ:7>1296.18<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO93GE<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2008<TIME_OFF:4>2008<CALL:7>G0EAK/P<RST_SENT:4>59 4<RST_RCVD:4>59 6<BAND:4>23cm<FREQ:8>1296.245<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO93NI<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2013<TIME_OFF:4>2013<CALL:5>G3SQQ<RST_SENT:4>59 5<RST_RCVD:5>56 10<BAND:4>23cm<FREQ:7>1296.23<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO93JC<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2025<TIME_OFF:4>2025<CALL:7>G1PPA/P<RST_SENT:4>59 6<RST_RCVD:5>59 15<BAND:4>23cm<FREQ:8>1296.325<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JO03AE<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2100<TIME_OFF:4>2100<CALL:5>G1HLT<RST_SENT:4>59 7<RST_RCVD:5>57 13<BAND:4>23cm<FREQ:8>1296.185<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO93JD<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2114<TIME_OFF:4>2114<CALL:5>G3VCA<RST_SENT:4>58 8<RST_RCVD:4>58 9<BAND:4>23cm<FREQ:7>1296.19<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO93MG<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2144<TIME_OFF:4>2144<CALL:7>G0WUS/P<RST_SENT:4>59 9<RST_RCVD:5>59 42<BAND:4>23cm<FREQ:8>1296.145<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO92MP<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2217<TIME_OFF:4>2217<CALL:5>G4CLA<RST_SENT:5>59 10<RST_RCVD:5>55 92<BAND:4>23cm<FREQ:7>1296.31<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO92JL<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>2227<TIME_OFF:4>2227<CALL:5>G7LRQ<RST_SENT:5>55 11<RST_RCVD:5>53 63<BAND:4>23cm<FREQ:8>1296.193<MODE:3>SSB<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IO91TQ<COMMENT:19>37 element Yagi/Uda<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>223<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:8>10 Watts<MY_RIG:7>IC-9700<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221221<TIME_ON:4>0935<TIME_OFF:4>0937<CALL:5>DJ8QP<RST_SENT:3>-07<RST_RCVD:3>-14<BAND:3>30m<FREQ:7>10.1378<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JN68JB<COMMENT:8>Vertical<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>230<CQZ:2>14<ITUZ:2>28<CONT:2>EU<TX_PWR:3>20W<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221221<TIME_ON:4>0939<TIME_OFF:4>0940<CALL:5>DK9CG<RST_SENT:3>-08<RST_RCVD:3>-06<BAND:3>30m<FREQ:7>10.1378<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JN58QD<COMMENT:8>Vertical<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>230<CQZ:2>14<ITUZ:2>28<CONT:2>EU<TX_PWR:3>20W<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221221<TIME_ON:4>0944<TIME_OFF:4>0945<CALL:5>LX1HD<RST_SENT:3>+07<RST_RCVD:3>-12<BAND:3>30m<FREQ:7>10.1378<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JN39AQ<COMMENT:8>Vertical<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>254<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:3>20W<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221221<TIME_ON:4>0953<TIME_OFF:4>0954<CALL:6>PE1PAF<RST_SENT:3>+10<RST_RCVD:3>+10<BAND:3>30m<FREQ:8>10.13785<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JO20VW<COMMENT:8>Vertical<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>263<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:3>20W<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221221<TIME_ON:4>0956<TIME_OFF:4>0957<CALL:6>PE2ENE<RST_SENT:3>-12<RST_RCVD:3>-04<BAND:3>30m<FREQ:8>10.13785<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>IN51OJ<COMMENT:8>Vertical<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>263<CQZ:2>14<ITUZ:2>27<CONT:2>EU<TX_PWR:3>20W<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
";

            AdifFile.TryParse(adif, out var adifFile).Should().BeTrue();

            adifFile.Records.Count.Should().Be(27);
        }

        [Fact]
        public void Vqlog2()
        {
            const string adif = @"Summary of QSO. Generated with VQLog 3.1 by EA6VQ (WWW.VQLOG.COM)
Selection of QSO worked by any callsign on all bands
Type of propagation: All                Mode: All mode
From 20/12/2022 to 21/12/2022           Distance over: 0 Km.
<PROGRAMID:5>VQLog
<PROGRAMVERSION:7>3.1.683
<EOH>
<QSO_DATE:8>20221220<TIME_ON:4>1826<TIME_OFF:4>1827<CALL:6>IT9DSZ<RST_SENT:3>-02<RST_RCVD:3>-04<BAND:3>30m<FREQ:7>10.1377<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>JM68PC<COMMENT:8>Vertical<QSO_COMPL:3>YES<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>248<CQZ:2>15<ITUZ:2>28<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
<QSO_DATE:8>20221220<TIME_ON:4>1833<TIME_OFF:4>1834<CALL:6>LZ1SAD<RST_SENT:3>-11<RST_RCVD:3>-13<BAND:3>30m<FREQ:7>10.1376<MODE:3>FT8<SWL:1>N<QSL_SENT:1>N<QSL_RCVD:1>N<GRIDSQUARE:6>KN22ID<COMMENT:8>Vertical<OPERATOR:5>G0DJA<MY_GRIDSQUARE:6>IO93IF<DXCC:3>212<CQZ:2>20<ITUZ:2>28<CONT:2>EU<TX_PWR:3>20W<MY_RIG:7>IC-7300<RND_METEORS:1>N<MS_SHOWER:1>N<FORCE_INIT:1>N<EOR>
";

            AdifFile.TryParse(adif, out var adifFile).Should().BeTrue();

            adifFile.Records.Count.Should().Be(2);
            adifFile.Records[1].QsoStart.Should().Be(new DateTime(2022, 12, 20, 18, 33, 0));
            adifFile.Records[1].QsoEnd.Should().Be(new DateTime(2022, 12, 20, 18, 34, 0));
            adifFile.Records[1].Call.Should().Be("LZ1SAD");
            adifFile.Records[1].RstSent.Should().Be("-11");
            adifFile.Records[1].Operator.Should().Be("G0DJA");
        }

        [Fact]
        public void RichardTestCloudlog()
        {
            const string adif = @"Cloudlog ADIF export
<ADIF_VER:5>3.1.2
<PROGRAMID:8>Cloudlog
<PROGRAMVERSION:11>Version 1.7
<EOH>

<BAND:3>40m
<CALL:5>EA8TN
<COUNTRY:14>Canary Islands
<CQZ:2>33
<DXCC:2>29
<EQSL_QSL_RCVD:1>Y
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>IL18UK
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-20
<RST_SENT:3>-06
<EQSL_QSLRDATE:8>20221210
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLRDATE:8>20221213
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075091
<QSO_DATE:8>20221210
<TIME_ON:6>030915
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>031015
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>TA8BB
<COUNTRY:6>Turkey
<CQZ:2>20
<DXCC:3>390
<EQSL_QSL_RCVD:1>Y
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:4>KM87
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-07
<RST_SENT:3>-11
<EQSL_QSLRDATE:8>20221210
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.074632
<QSO_DATE:8>20221210
<TIME_ON:6>031145
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>031230
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:6>HB9EFK
<COUNTRY:11>Switzerland
<CQZ:2>14
<DXCC:3>287
<EQSL_QSL_RCVD:1>Y
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>JN47FE
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+02
<RST_SENT:3>-06
<EQSL_QSLRDATE:8>20221210
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLRDATE:8>20221212
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.074862
<QSO_DATE:8>20221210
<TIME_ON:6>090600
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>090700
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:9>PD22SANTA
<COUNTRY:11>Netherlands
<CQZ:2>14
<DXCC:3>263
<EQSL_QSL_SENT:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+03
<RST_SENT:3>+06
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075043
<QSO_DATE:8>20221210
<TIME_ON:6>090730
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>090830
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:6>PE1NPS
<COUNTRY:11>Netherlands
<CQZ:2>14
<DXCC:3>263
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>JO22OF
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+02
<RST_SENT:3>+02
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLRDATE:8>20221213
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075043
<QSO_DATE:8>20221210
<TIME_ON:6>090815
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>090930
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>K8SEL
<COUNTRY:24>United States Of America
<CQZ:1>5
<DXCC:3>291
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>EM98AT
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-16
<RST_SENT:3>-24
<STATE:2>WV
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLRDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.076332
<QSO_DATE:8>20221210
<TIME_ON:6>091500
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>091500
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>G0KPH
<COUNTRY:7>England
<CQZ:2>14
<DXCC:3>223
<EQSL_QSL_RCVD:1>Y
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>IO92FH
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+07
<RST_SENT:3>+07
<EQSL_QSLRDATE:8>20221210
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLRDATE:8>20221211
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.076332
<QSO_DATE:8>20221210
<TIME_ON:6>091530
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>091600
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>LY2EW
<COUNTRY:9>Lithuania
<CQZ:2>15
<DXCC:3>146
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>KO25KH
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-02
<RST_SENT:3>-11
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLRDATE:8>20221212
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.076332
<QSO_DATE:8>20221210
<TIME_ON:6>091630
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>091730
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:4>K2PL
<COUNTRY:24>United States Of America
<CQZ:1>5
<DXCC:3>291
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>FM26AR
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-10
<RST_SENT:3>-16
<STATE:2>VA
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLRDATE:8>20221212
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07463
<QSO_DATE:8>20221210
<TIME_ON:6>091915
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>092200
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:6>MM0DHQ
<COUNTRY:8>Scotland
<CQZ:2>14
<DXCC:3>279
<EQSL_QSL_RCVD:1>Y
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>IO75PP
<IOTA:6>EU-005
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-08
<RST_SENT:3>-07
<EQSL_QSLRDATE:8>20221210
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLRDATE:8>20221211
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.076445
<QSO_DATE:8>20221210
<TIME_ON:6>092245
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>092345
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:8>PA22XMAS
<COUNTRY:11>Netherlands
<CQZ:2>14
<DXCC:3>263
<EQSL_QSL_SENT:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-12
<RST_SENT:3>-03
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075073
<QSO_DATE:8>20221210
<TIME_ON:6>093945
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>094030
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>F4JGI
<COUNTRY:6>France
<CQZ:2>14
<DXCC:3>227
<EQSL_QSL_RCVD:1>Y
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:6>IN94RQ
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+06
<RST_SENT:3>-15
<EQSL_QSLRDATE:8>20221210
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLRDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075505
<QSO_DATE:8>20221210
<TIME_ON:6>094300
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>094430
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>M0PAW
<COUNTRY:7>England
<CQZ:2>14
<DXCC:3>223
<EQSL_QSL_SENT:1>Y
<GRIDSQUARE:4>IO80
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-02
<RST_SENT:3>-05
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.074999
<QSO_DATE:8>20221210
<TIME_ON:6>094600
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>095001
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:8>PA22XMAS
<COUNTRY:11>Netherlands
<CQZ:2>14
<DXCC:3>263
<EQSL_QSL_SENT:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-06
<RST_SENT:3>-01
<EQSL_QSLSDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075073
<QSO_DATE:8>20221210
<TIME_ON:6>095230
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>095330
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:8>TM22YOTA
<COUNTRY:6>France
<CQZ:2>14
<DXCC:3>227
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-03
<RST_SENT:3>+03
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075283
<QSO_DATE:8>20221210
<TIME_ON:6>095745
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>095845
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>OM3PC
<COUNTRY:15>Slovak Republic
<CQZ:2>15
<DXCC:3>504
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-16
<RST_SENT:3>-02
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07565
<QSO_DATE:8>20221210
<TIME_ON:6>100145
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>100245
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>DJ1AA
<COUNTRY:27>Federal Republic Of Germany
<CQZ:2>14
<DXCC:3>230
<GRIDSQUARE:4>JO41
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+08
<RST_SENT:3>+06
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075354
<QSO_DATE:8>20221210
<TIME_ON:6>114915
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>115015
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>M0BSI
<COUNTRY:7>England
<CQZ:2>14
<DXCC:3>223
<GRIDSQUARE:4>IO70
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+01
<RST_SENT:3>-16
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075225
<QSO_DATE:8>20221210
<TIME_ON:6>115615
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>115715
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>F4JGI
<COUNTRY:6>France
<CQZ:2>14
<DXCC:3>227
<GRIDSQUARE:6>IN94RQ
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-24
<RST_SENT:3>-19
<LOTW_QSLRDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>120515
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>120601
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>PD1WS
<COUNTRY:11>Netherlands
<CQZ:2>14
<DXCC:3>263
<GRIDSQUARE:6>JO22PH
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+02
<RST_SENT:3>-05
<LOTW_QSLRDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>120645
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>120730
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:6>PE1DDA
<COUNTRY:11>Netherlands
<CQZ:2>14
<DXCC:3>263
<GRIDSQUARE:4>JO22
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+02
<RST_SENT:3>-05
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>120845
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>120930
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:6>DL4DAC
<COUNTRY:27>Federal Republic Of Germany
<CQZ:2>14
<DXCC:3>230
<GRIDSQUARE:6>JO31LL
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+03
<RST_SENT:3>-07
<LOTW_QSLRDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>121015
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>121100
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>G6ZRV
<COUNTRY:7>England
<CQZ:2>14
<DXCC:3>223
<GRIDSQUARE:4>JO02
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+18
<RST_SENT:3>+09
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>121215
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>121300
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>DK5EO
<COUNTRY:27>Federal Republic Of Germany
<CQZ:2>14
<DXCC:3>230
<GRIDSQUARE:6>JO31MG
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-12
<RST_SENT:3>-11
<LOTW_QSLRDATE:8>20221211
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>121415
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>121500
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>M0VTS
<COUNTRY:7>England
<CQZ:2>14
<DXCC:3>223
<GRIDSQUARE:4>IO82
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-03
<RST_SENT:3>+04
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>121530
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>121600
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>PA1ZT
<COUNTRY:11>Netherlands
<CQZ:2>14
<DXCC:3>263
<GRIDSQUARE:4>JO21
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-03
<RST_SENT:3>-12
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>121645
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>121730
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:6>DG3OBK
<COUNTRY:27>Federal Republic Of Germany
<CQZ:2>14
<DXCC:3>230
<GRIDSQUARE:4>JO52
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+03
<RST_SENT:3>-08
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>121815
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>121900
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:6>DL2ART
<COUNTRY:27>Federal Republic Of Germany
<CQZ:2>14
<DXCC:3>230
<GRIDSQUARE:6>JO30IU
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-01
<RST_SENT:3>-05
<LOTW_QSLRDATE:8>20221211
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>122015
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>122100
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>G3XKT
<COUNTRY:7>England
<CQZ:2>14
<DXCC:3>223
<GRIDSQUARE:4>IO92
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+15
<RST_SENT:3>+05
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>122115
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>122200
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>DB8LD
<COUNTRY:27>Federal Republic Of Germany
<CQZ:2>14
<DXCC:3>230
<GRIDSQUARE:4>JO54
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-04
<RST_SENT:3>+00
<LOTW_QSLSDATE:8>20221210
<FREQ:7>7.07521
<QSO_DATE:8>20221210
<TIME_ON:6>122215
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>122300
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:5>ES6DO
<COUNTRY:7>Estonia
<CQZ:2>15
<DXCC:2>52
<GRIDSQUARE:6>KO27WX
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-15
<RST_SENT:3>-05
<LOTW_QSLRDATE:8>20221219
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.075618
<QSO_DATE:8>20221210
<TIME_ON:6>134145
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>134245
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:4>OT4R
<COUNTRY:7>Belgium
<CQZ:2>14
<DXCC:3>209
<GRIDSQUARE:6>JO21BE
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>+05
<RST_SENT:3>+01
<LOTW_QSLRDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:8>7.076357
<QSO_DATE:8>20221210
<TIME_ON:6>134630
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>134745
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>40m
<CALL:6>SP4MPH
<COUNTRY:6>Poland
<CQZ:2>15
<DXCC:3>269
<GRIDSQUARE:6>KO14LC
<LOTW_QSL_RCVD:1>Y
<LOTW_QSL_SENT:1>Y
<MODE:3>FT8
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_RCVD:3>-03
<RST_SENT:3>+01
<LOTW_QSLRDATE:8>20221210
<LOTW_QSLSDATE:8>20221210
<FREQ:6>7.0744
<QSO_DATE:8>20221210
<TIME_ON:6>135430
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>135530
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

<BAND:3>20m
<CALL:6>OK2ZCH
<COUNTRY:14>Czech Republic
<CQZ:2>15
<DISTANCE:1>0
<DXCC:3>503
<EQSL_QSL_RCVD:1>N
<EQSL_QSL_SENT:1>N
<LOTW_QSL_RCVD:1>N
<LOTW_QSL_SENT:1>Y
<MODE:4>SSTV
<OPERATOR:5>M0OFX
<QRZCOM_QSO_UPLOAD_STATUS:1>N
<QSL_RCVD:1>N
<QSL_SENT:1>N
<RST_SENT:3>555
<TX_PWR:3>100
<LOTW_QSLSDATE:8>20221210
<FREQ:5>14.23
<QSO_DATE:8>20221210
<TIME_ON:6>145605
<QSO_DATE_OFF:8>20221210
<TIME_OFF:6>145605
<STATION_CALLSIGN:5>M0OFX
<MY_CITY:5>Leeds
<MY_COUNTRY:7>ENGLAND
<MY_DXCC:3>223
<MY_GRIDSQUARE:6>IO93GT
<MY_CQ_ZONE:2>14
<MY_ITU_ZONE:2>27
<EOR>

";

            AdifFile.TryParse(adif, out var adifFile).Should().BeTrue();

            adifFile.Records.Last().Call.Should().Be("OK2ZCH");
        }

        [Fact]
        public void Qrz()
        {
            const string adif = @"QRZLogbook download for g6nwf
    Date: Tue Dec 27 12:11:48 2022
    Bookid: 313258
    Records: 139
    <ADIF_VER:5>3.1.1
    <PROGRAMID:10>QRZLogbook
    <PROGRAMVERSION:3>2.0
    <eoh>
<app_qrzlog_logid:9>844684627
<app_qrzlog_qsldate:8>20221210
<app_qrzlog_status:1>C
<band:3>40m
<band_rx:3>40m
<call:6>JR1LZK
<comment:25>FT8  Sent: -15  Rcvd: -19
<cont:2>AS
<country:5>Japan
<cqz:2>25
<distance:4>9609
<dxcc:3>339
<email:18>tasaki27@gmail.com
<freq:7>7.07512
<freq_rx:7>7.07512
<gridsquare:6>QM06FI
<iota:6>AS-007
<ituz:1>3
<lat:11>N036 22.174
<lon:11>E140 29.950
<lotw_qsl_rcvd:1>Y
<lotw_qsl_sent:1>Y
<lotw_qslrdate:8>20221210
<lotw_qslsdate:8>20221209
<mode:3>FT8
<my_city:7>Bristol
<my_country:7>England
<my_cq_zone:2>14
<my_gridsquare:6>IO81RK
<my_itu_zone:2>27
<my_lat:11>N051 26.200
<my_lon:11>W002 32.600
<my_name:13>Roger O Parry
<name:13>YUTAKA TASAKI
<qrzcom_qso_upload_date:8>20221209
<qrzcom_qso_upload_status:1>Y
<qsl_rcvd:1>N
<qsl_sent:1>N
<qsl_via:21>DIRECT/LOTW/BURO/eQSL
<qso_date:8>20221209
<qso_date_off:8>20221209
<qth:13>MITO, IBARAKI
<rst_rcvd:3>-19
<rst_sent:3>-15
<station_callsign:5>G6NWF
<time_off:4>0801
<time_on:4>0801
<tx_pwr:2>60
<eor>

<app_qrzlog_logid:9>844684730
<app_qrzlog_qsldate:8>20221209
<app_qrzlog_status:1>C
<band:3>40m
<band_rx:3>40m
<call:6>JR1FYS
<comment:25>FT8  Sent: -07  Rcvd: -09
<cont:2>AS
<country:5>Japan
<cqz:2>25
<distance:4>9645
<dxcc:3>339
<email:16>jr1fys@gmail.com
<freq:7>7.07512
<freq_rx:7>7.07512
<gridsquare:6>QM05EX
<iota:6>AS-007
<ituz:2>45
<lat:11>N035 58.576
<lon:11>E140 21.317
<lotw_qsl_rcvd:1>Y
<lotw_qsl_sent:1>Y
<lotw_qslrdate:8>20221209
<lotw_qslsdate:8>20221209
<mode:3>FT8
<my_city:7>Bristol
<my_country:7>England
<my_cq_zone:2>14
<my_gridsquare:6>IO81RK
<my_itu_zone:2>27
<my_lat:11>N051 26.200
<my_lon:11>W002 32.600
<my_name:13>Roger O Parry
<name:15>Hiroshi Nagaosa
<qrzcom_qso_upload_date:8>20221209
<qrzcom_qso_upload_status:1>Y
<qsl_rcvd:1>N
<qsl_sent:1>N
<qsl_via:20>BUREAU, DIRECT, LOTW
<qso_date:8>20221209
<qso_date_off:8>20221209
<qth:18>Inashiki, Ibaraki,
<rst_rcvd:3>-09
<rst_sent:3>-07
<station_callsign:5>G6NWF
<time_off:4>0803
<time_on:4>0802
<tx_pwr:2>60
<eor>";

            var parsed = AdifFile.TryParse(adif, out var adifFile, out var reason);

            reason.Should().BeNull();
            parsed.Should().BeTrue();

            adifFile.Records.Count.Should().Be(2);
            adifFile.Records[1].Fields["name"].Should().Be("Hiroshi Nagaosa");
        }

        [Fact]
        public void FieldLengthWithDateType()
        {
            const string adif = @"ADIF Export from Logger32 Version [4.0]
Copyright 2001-2023  Robert C. Furzer.
Logs generated on 05 Sep 2023 at 18:14:51 UTC by : YO2LSP.
File output restricted to QSOs by : All Operators - All Bands - All Modes
<PROGRAMID:8>LOGGER32
<PROGRAMVERSION:7>4.0.311
<EOH>

<BAND:3>40m <CALL:6>GD4VBA <COMMENT:25>FT8  Sent: -16  Rcvd: -01 <CONT:2>EU <CQZ:2>14 <DXCC:3>114 <FREQ:8>7.076418 <ITUZ:2>27 <MODE:3>FT8 <OPERATOR:6>YO2LSP <PFX:3>GD4 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>180945 <RST_RCVD:3>-01 <RST_SENT:3>-16 <K_INDEX:1>3 <TIME_OFF:6>181059 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14186 <FREQ_RX:8>7.076418 <COUNTRY:11>Isle of Man <APP_LOGGER32_LAT:4>54.3 <APP_LOGGER32_LNG:3>4.5 <EOR>

<DISTANCE:3>253 <BAND:3>40m <CALL:5>HA7TM <COMMENT:25>FT8  Sent: -04  Rcvd: +03 <CONT:2>EU <CQZ:2>15 <DXCC:3>239 <FREQ:8>7.076418 <GRIDSQUARE:6>JN97kk <ITUZ:2>28 <MODE:3>FT8 <OPERATOR:6>YO2LSP <PFX:3>HA7 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>181100 <RST_RCVD:3>+03 <RST_SENT:3>-04 <K_INDEX:1>3 <TIME_OFF:6>181159 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14187 <FREQ_RX:8>7.076417 <COUNTRY:7>Hungary <APP_LOGGER32_LAT:7>47.4375 <APP_LOGGER32_LNG:7>-18.875 <EOR>

<DISTANCE:5>61.72 <BAND:3>40m <CALL:7>YP20KQT <CONT:2>EU <CQZ:2>20 <DXCC:3>275 <FREQ:8>7.074500 <ITUZ:2>28 <MODE:3>SSB <OPERATOR:6>YO2LSP <PFX:4>YP20 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>181320 <RST_RCVD:2>59 <RST_SENT:2>59 <K_INDEX:1>3 <TIME_OFF:6>181320 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14188 <FREQ_RX:8>7.150000 <COUNTRY:7>Romania <APP_LOGGER32_LAT:5>45.74 <APP_LOGGER32_LNG:6>-21.92 <EOR>

<DISTANCE:5>61.72 <BAND:3>40m <CALL:7>YP20KQT <CONT:2>EU <CQZ:2>20 <DXCC:3>275 <FREQ:8>7.074500 <ITUZ:2>28 <MODE:3>SSB <OPERATOR:6>YO2LSP <PFX:4>YP20 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>181342 <RST_RCVD:2>59 <RST_SENT:2>59 <K_INDEX:1>3 <TIME_OFF:6>181342 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14189 <FREQ_RX:8>3.796000 <COUNTRY:7>Romania <APP_LOGGER32_LAT:5>45.74 <APP_LOGGER32_LNG:6>-21.92 <EOR>

<DISTANCE:5>61.72 <BAND:3>40m <CALL:7>YP20KQT <CONT:2>EU <CQZ:2>20 <DXCC:3>275 <FREQ:8>7.074500 <ITUZ:2>28 <MODE:3>SSB <OPERATOR:6>YO2LSP <PFX:4>YP20 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>181402 <RST_RCVD:2>59 <RST_SENT:2>59 <K_INDEX:1>3 <TIME_OFF:6>181402 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14190 <FREQ_RX:9>14.200000 <COUNTRY:7>Romania <APP_LOGGER32_LAT:5>45.74 <APP_LOGGER32_LNG:6>-21.92 <EOR>

";

            AdifFile.TryParse(adif, out var adifFile).Should().BeTrue();

            adifFile.Records.Count.Should().Be(5);
            adifFile.Records[1].QsoStart.Should().Be(new DateTime(2023, 9, 5, 18, 11, 0));
            adifFile.Records[1].QsoEnd.Should().Be(new DateTime(2023, 9, 5, 18, 11, 59));
        }

        [Fact]
        public void WriteAdifWithNull()
        {
            var adifFile = new AdifFile();
            adifFile.Records.Add(new AdifContactRecord
            {
                GridSquare = null
            });
            adifFile.ToString().Replace("\r\n", "\n").Should().Be("<eoh>\n\n\n<eor>");
        }

        [Fact]
        public void WriteAdif()
        {
            const string adif = @"ADIF Export from Logger32 Version [4.0]
Copyright 2001-2023  Robert C. Furzer.
Logs generated on 05 Sep 2023 at 18:14:51 UTC by : YO2LSP.
File output restricted to QSOs by : All Operators - All Bands - All Modes
<PROGRAMID:8>LOGGER32
<PROGRAMVERSION:7>4.0.311
<EOH>

<BAND:3>40m <CALL:6>GD4VBA <COMMENT:25>FT8  Sent: -16  Rcvd: -01 <CONT:2>EU <CQZ:2>14 <DXCC:3>114 <FREQ:8>7.076418 <ITUZ:2>27 <MODE:3>FT8 <OPERATOR:6>YO2LSP <PFX:3>GD4 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>180945 <RST_RCVD:3>-01 <RST_SENT:3>-16 <K_INDEX:1>3 <TIME_OFF:6>181059 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14186 <FREQ_RX:8>7.076418 <COUNTRY:11>Isle of Man <APP_LOGGER32_LAT:4>54.3 <APP_LOGGER32_LNG:3>4.5 <EOR>

<DISTANCE:3>253 <BAND:3>40m <CALL:5>HA7TM <COMMENT:25>FT8  Sent: -04  Rcvd: +03 <CONT:2>EU <CQZ:2>15 <DXCC:3>239 <FREQ:8>7.076418 <GRIDSQUARE:6>JN97kk <ITUZ:2>28 <MODE:3>FT8 <OPERATOR:6>YO2LSP <PFX:3>HA7 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>181100 <RST_RCVD:3>+03 <RST_SENT:3>-04 <K_INDEX:1>3 <TIME_OFF:6>181159 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14187 <FREQ_RX:8>7.076417 <COUNTRY:7>Hungary <APP_LOGGER32_LAT:7>47.4375 <APP_LOGGER32_LNG:7>-18.875 <EOR>

<DISTANCE:5>61.72 <BAND:3>40m <CALL:7>YP20KQT <CONT:2>EU <CQZ:2>20 <DXCC:3>275 <FREQ:8>7.074500 <ITUZ:2>28 <MODE:3>SSB <OPERATOR:6>YO2LSP <PFX:4>YP20 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>181320 <RST_RCVD:2>59 <RST_SENT:2>59 <K_INDEX:1>3 <TIME_OFF:6>181320 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14188 <FREQ_RX:8>7.150000 <COUNTRY:7>Romania <APP_LOGGER32_LAT:5>45.74 <APP_LOGGER32_LNG:6>-21.92 <EOR>

<DISTANCE:5>61.72 <BAND:3>40m <CALL:7>YP20KQT <CONT:2>EU <CQZ:2>20 <DXCC:3>275 <FREQ:8>7.074500 <ITUZ:2>28 <MODE:3>SSB <OPERATOR:6>YO2LSP <PFX:4>YP20 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>181342 <RST_RCVD:2>59 <RST_SENT:2>59 <K_INDEX:1>3 <TIME_OFF:6>181342 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14189 <FREQ_RX:8>3.796000 <COUNTRY:7>Romania <APP_LOGGER32_LAT:5>45.74 <APP_LOGGER32_LNG:6>-21.92 <EOR>

<DISTANCE:5>61.72 <BAND:3>40m <CALL:7>YP20KQT <CONT:2>EU <CQZ:2>20 <DXCC:3>275 <FREQ:8>7.074500 <ITUZ:2>28 <MODE:3>SSB <OPERATOR:6>YO2LSP <PFX:4>YP20 <APP_LOGGER32_eQSL:1>Y <APP_LOGGER32_LoTW:1>Y <EQSL_SEND:1>Y <LOTW_SEND:1>Y <QSO_DATE:8:D>20230905 <TIME_ON:6>181402 <RST_RCVD:2>59 <RST_SENT:2>59 <K_INDEX:1>3 <TIME_OFF:6>181402 <SFI:3>136 <A_INDEX:1>8 <APP_LOGGER32_QSO_NUMBER:5>14190 <FREQ_RX:9>14.200000 <COUNTRY:7>Romania <APP_LOGGER32_LAT:5>45.74 <APP_LOGGER32_LNG:6>-21.92 <EOR>

";

            AdifFile.TryParse(adif, out var adifFile);

            adifFile.ToString().Replace("\r\n", "\n").Should().Be(@"<PROGRAMID:8>LOGGER32
<PROGRAMVERSION:7>4.0.311
<eoh>

<BAND:3>40m
<CALL:6>GD4VBA
<COMMENT:25>FT8  Sent: -16  Rcvd: -01
<CONT:2>EU
<CQZ:2>14
<DXCC:3>114
<FREQ:8>7.076418
<ITUZ:2>27
<MODE:3>FT8
<OPERATOR:6>YO2LSP
<PFX:3>GD4
<APP_LOGGER32_eQSL:1>Y
<APP_LOGGER32_LoTW:1>Y
<EQSL_SEND:1>Y
<LOTW_SEND:1>Y
<QSO_DATE:8>20230905
<TIME_ON:6>180945
<RST_RCVD:3>-01
<RST_SENT:3>-16
<K_INDEX:1>3
<TIME_OFF:6>181059
<SFI:3>136
<A_INDEX:1>8
<APP_LOGGER32_QSO_NUMBER:5>14186
<FREQ_RX:8>7.076418
<COUNTRY:11>Isle of Man
<APP_LOGGER32_LAT:4>54.3
<APP_LOGGER32_LNG:3>4.5
<eor>

<DISTANCE:3>253
<BAND:3>40m
<CALL:5>HA7TM
<COMMENT:25>FT8  Sent: -04  Rcvd: +03
<CONT:2>EU
<CQZ:2>15
<DXCC:3>239
<FREQ:8>7.076418
<GRIDSQUARE:6>JN97kk
<ITUZ:2>28
<MODE:3>FT8
<OPERATOR:6>YO2LSP
<PFX:3>HA7
<APP_LOGGER32_eQSL:1>Y
<APP_LOGGER32_LoTW:1>Y
<EQSL_SEND:1>Y
<LOTW_SEND:1>Y
<QSO_DATE:8>20230905
<TIME_ON:6>181100
<RST_RCVD:3>+03
<RST_SENT:3>-04
<K_INDEX:1>3
<TIME_OFF:6>181159
<SFI:3>136
<A_INDEX:1>8
<APP_LOGGER32_QSO_NUMBER:5>14187
<FREQ_RX:8>7.076417
<COUNTRY:7>Hungary
<APP_LOGGER32_LAT:7>47.4375
<APP_LOGGER32_LNG:7>-18.875
<eor>

<DISTANCE:5>61.72
<BAND:3>40m
<CALL:7>YP20KQT
<CONT:2>EU
<CQZ:2>20
<DXCC:3>275
<FREQ:8>7.074500
<ITUZ:2>28
<MODE:3>SSB
<OPERATOR:6>YO2LSP
<PFX:4>YP20
<APP_LOGGER32_eQSL:1>Y
<APP_LOGGER32_LoTW:1>Y
<EQSL_SEND:1>Y
<LOTW_SEND:1>Y
<QSO_DATE:8>20230905
<TIME_ON:6>181320
<RST_RCVD:2>59
<RST_SENT:2>59
<K_INDEX:1>3
<TIME_OFF:6>181320
<SFI:3>136
<A_INDEX:1>8
<APP_LOGGER32_QSO_NUMBER:5>14188
<FREQ_RX:8>7.150000
<COUNTRY:7>Romania
<APP_LOGGER32_LAT:5>45.74
<APP_LOGGER32_LNG:6>-21.92
<eor>

<DISTANCE:5>61.72
<BAND:3>40m
<CALL:7>YP20KQT
<CONT:2>EU
<CQZ:2>20
<DXCC:3>275
<FREQ:8>7.074500
<ITUZ:2>28
<MODE:3>SSB
<OPERATOR:6>YO2LSP
<PFX:4>YP20
<APP_LOGGER32_eQSL:1>Y
<APP_LOGGER32_LoTW:1>Y
<EQSL_SEND:1>Y
<LOTW_SEND:1>Y
<QSO_DATE:8>20230905
<TIME_ON:6>181342
<RST_RCVD:2>59
<RST_SENT:2>59
<K_INDEX:1>3
<TIME_OFF:6>181342
<SFI:3>136
<A_INDEX:1>8
<APP_LOGGER32_QSO_NUMBER:5>14189
<FREQ_RX:8>3.796000
<COUNTRY:7>Romania
<APP_LOGGER32_LAT:5>45.74
<APP_LOGGER32_LNG:6>-21.92
<eor>

<DISTANCE:5>61.72
<BAND:3>40m
<CALL:7>YP20KQT
<CONT:2>EU
<CQZ:2>20
<DXCC:3>275
<FREQ:8>7.074500
<ITUZ:2>28
<MODE:3>SSB
<OPERATOR:6>YO2LSP
<PFX:4>YP20
<APP_LOGGER32_eQSL:1>Y
<APP_LOGGER32_LoTW:1>Y
<EQSL_SEND:1>Y
<LOTW_SEND:1>Y
<QSO_DATE:8>20230905
<TIME_ON:6>181402
<RST_RCVD:2>59
<RST_SENT:2>59
<K_INDEX:1>3
<TIME_OFF:6>181402
<SFI:3>136
<A_INDEX:1>8
<APP_LOGGER32_QSO_NUMBER:5>14190
<FREQ_RX:9>14.200000
<COUNTRY:7>Romania
<APP_LOGGER32_LAT:5>45.74
<APP_LOGGER32_LNG:6>-21.92
<eor>".Replace("\r\n", "\n"));
        }

        [Fact]
        public void TimeZoneHandling()
        {
            var qsoStart = DateTime.ParseExact("20230919155059", "yyyyMMddHHmmss", CultureInfo.InvariantCulture, DateTimeStyles.AssumeUniversal);

            var record = new AdifContactRecord { QsoStart = qsoStart };

            var output = record.ToString();

            NormaliseLineBreaks(output).Should().Be(NormaliseLineBreaks(@"<qso_date:8>20230919
<time_on:6>155059
<eor>"));
        }


        private static string NormaliseLineBreaks(string output) => output?.Replace("\r\n", "\n");
    }
}